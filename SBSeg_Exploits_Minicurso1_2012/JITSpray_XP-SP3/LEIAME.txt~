Explicação dos arquivos usados para criar um exploit que usa JIT spraying:

- main.as

	Contém o esqueleto do código action script que compõe o arquivo "jit-spray.as". Esse esqueleto é usado pelo script "eggcodegen.pl" para gerar o arquivo "jit-spry.as".

- metasploit_shellcode_output.txt (nome original usado pelo Alexey Sintsov = bind4444)

	Arquivo com o código hexadecimal do 2º estágio do shellcode. Esse arquivo deve ser criado a partir da saída do "msfpayload" para o formato usado em scripts "perl". Exemplo:

		msfpayload windows/messagebox EXITFUNC=process ICON=NO TEXT='Minicurso 1 do SBSeg 2012!' TITLE='Explorado por mateustymbu' P > metasploit_shellcode_output.txt

	É importante lembrar de trocar no arquivo gerado (metasploit_shellcode_output.txt) a diretiva "my" por "our".

- eggcodegen.pl

	Script que recebe como parâmetro o nome do arquivo que contém o 2º estágio do shellcode no formato hexadecimal exportado pelo metasploit para scripts perl. Esse script usa o esqueleto contido em "main.as" e o arquivo recebido como parâmetro para gerar o arquivo "jit-spray.as".

- jit-spray.as

	Código em Action Script que pulveriza o heap com o conteúdo do arquivo binário "jit_egg.swf". O arquivo "jit-spray.as" também instancia na memória o 2º estágio do shellcode. Esse arquivo deve ser gerado através do seguinte comando/script:

		perl eggcodegen.pl metasploit_shellcode_output.txt > jit-spray.as

	Depois, o código action script deve ser compilado no Windows (é necessário instalar o compilador "as3compiler.exe" do SWFTOOLS - http://www.swftools.org/) através do seguinte comando:

		as3compile -X 320 -Y 300 -M Loadzz1 jit-spray.as

	Será gerado o arquivo "jit-spray.swf", que deverá ser carregado pela página "html" do exploit.

- UNI_EGG.txt

	Arquivo texto que contém o código hexadecimal das instruções que compõem o Egg Hunter. Esse arquivo é convertido pelo script "remake.pl" no formato action script para gerar o código final do arquivo com o Egg Hunter.

- remake.pl

	Script que usa o arquivo "UNI_EGG.txt" para gerar o arquivo action script com o código do Egg Hunter (jit_egg.as -> arquivo que será pulverizado)

- jit_egg.as

	Código em Action Script que contém o Egg Hunter na forma de instuções XOR, o que garante a sua marcação como executável (supera o DEP). Esse arquivo deve ser gerado através do seguinte comando/script:

		perl remake.pl > jit_egg.as

	Depois, o código action script deve ser compilado no Windows (é necessário instalar o compilador "as3compiler" do SWFTOOLS - http://www.swftools.org/) através do seguinte comando:

		as3compile -X 640 -Y 480 -M Loadzz2 jit_egg.as

	Será gerado o arquivo jit_egg.swf, que é pulverizado na memória pelo código contido em "jit-spray.swf".

- JIT-SPRAY.html

	Arquivo carregado pelo navegador que carrega e inicia a execução dos arquivos flash/ActionScript que contêm o código do exploit (jit-spray.swf e jit_egg.swf).

